<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>再见丁真</title>
  <link rel="stylesheet" type="text/css" href="style/main.css" />

  <script type="module" src="script/main.js" defer></script>
</head>

<body>
  <main>
    <div class="loading-container">
      <h2 class="loading-title">少女祈祷中</h2>
      <div class="loading-progress-container">
        <div class="loading-progress-bar">
          <div class="loading-progress-fill"></div>
        </div>
      </div>
      <div class="loading-status">准备加载资源...</div>
      <div class="loading-action hidden">
        <button id="loading-retry">重试</button>
        <button id="loading-skip">跳过</button>
      </div>
      <div class="loading-error hidden"></div>
    </div>

    <img id="game2d-background" class="hidden" />

    <canvas id="game-canvas"></canvas>

    <div id="save-notification" class="save-notification hidden">
      <div class="save-icon">💾</div>
      <div class="save-text">游戏已保存</div>
    </div>

    <div class="dialogue-container">
      <div class="modern-style-text">
        <div style="width: min-content">
          <div class="subtitle"></div>
          <div class="title"></div>
        </div>
        <div class="text"></div>
      </div>
      <div class="touhou-style-text text">
        <svg width="40" height="40" viewBox="-10 -50 90 100">
          <path d="M -10 0 H 0 C 40 0 50 -40 50 -40 C 50 -40 40 0 62 11 Z" fill="#ffeca7" />
          <path d="M -10 0 H 0 C 40 0 50 -40 50 -40 C 50 -40 40 0 62 11" fill="none" stroke="#000" stroke-width="5.3" />
        </svg>
      </div>
    </div>

    <!-- 暂停界面 -->
    <div id="pause-overlay" class="pause-overlay">
      <div class="pause-menu">
        <h2 class="pause-title">游戏暂停</h2>
        <div class="pause-buttons">
          <button id="resume-btn" class="pause-btn">继续游戏</button>
          <button id="save-btn" class="pause-btn">保存游戏</button>
          <button id="load-btn" class="pause-btn">读取存档</button>
          <button id="help-btn" class="pause-btn">游戏帮助</button>
          <button id="title-btn" class="pause-btn danger">返回标题</button>
        </div>
      </div>
    </div>

    <!-- 存档管理界面 -->
    <div id="save-manager-modal" class="save-manager-modal">
      <div class="save-manager-content">
        <div class="save-manager-header">
          <h2 class="save-manager-title">选择存档</h2>
          <button id="save-manager-close" class="save-manager-close">&times;</button>
        </div>
        <div class="save-list-container">
          <div id="save-list" class="save-list">
            <!-- 存档列表将在这里动态生成 -->
          </div>
        </div>
      </div>
    </div>

    <!-- 帮助界面 -->
    <div id="help-modal" class="help-modal">
      <div class="help-content">
        <div class="help-header">
          <h2 class="help-title">游戏帮助</h2>
          <button id="help-close" class="help-close">&times;</button>
        </div>
        <div class="help-text">
          <h3>基本操作</h3>
          <ul>
            <li><kbd>空格</kbd> 或 <kbd>Enter</kbd> - 进行对话</li>
            <li><kbd>Ctrl</kbd> - 对话快进</li>
            <br>
            <li><kbd>E</kbd> - 交互</li>
            <li><kbd>A/D</kbd> - 左右移动</li>
            <li><kbd>空格</kbd> - 跳跃</li>
            <li><kbd>Esc</kbd> - 暂停游戏</li>
          </ul>

          <h3>高级技巧</h3>
          <ul>
            <li><strong>土狼时间</strong>：离开平台后0.15秒内仍可跳跃</li>
            <li><strong>二段跳</strong>：在空中可以再跳跃1次</li>
            <li><strong>跳跃缓冲</strong>：提前按跳跃键会在落地时自动跳跃</li>
            <li><strong>时间回溯</strong>：长按 <kbd>R</kbd> 键可回到过去</li>
          </ul>
        </div>
      </div>
    </div>
  </main>
</body>

</html>