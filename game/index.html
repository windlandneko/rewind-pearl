<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>再见丁真</title>
  <link rel="stylesheet" type="text/css" href="style/main.css" />

  <script type="module" src="script/main.js" defer></script>
</head>

<body>
  <main>
    <!-- 加载界面 -->
    <div class="loading-container">
      <h2 class="loading-title">少女祈祷中</h2>
      <div class="loading-progress-container">
        <div class="loading-progress-bar">
          <div class="loading-progress-fill"></div>
        </div>
      </div>
      <div class="loading-status">准备加载资源...</div>
      <div class="loading-action hidden">
        <button id="loading-retry">重试</button>
        <button id="loading-skip">跳过</button>
      </div>
      <div class="loading-error hidden"></div>
    </div>

    <!-- 背景容器：固定底图 + 两个可视差浮动图层 -->
    <div id="game2d-background" class="hidden">
      <img id="bg-base" class="bg-image" />
      <img id="bg-layer-1" class="bg-image layer-1" />
      <img id="bg-layer-2" class="bg-image layer-2" />
    </div>

    <canvas id="game-canvas"></canvas>

    <!-- 保存提示 -->
    <div id="save-notification" class="save-notification hidden">
      <div class="save-icon">💾</div>
      <div class="save-text">游戏已保存</div>
    </div>

    <!-- 对话框 -->
    <div class="dialogue-container">
      <div class="dialogue-background"></div>
      <div class="modern-style-text">
        <div class="speaker-box">
          <div class="subtitle"></div>
          <div class="title"></div>
        </div>
        <div class="text-box">
          <div class="text"></div>
        </div>
      </div>
      <div class="touhou-style-text text">
        <svg width="40" height="40" viewBox="-10 -50 90 100">
          <path d="M -10 0 H 0 C 40 0 50 -40 50 -40 C 50 -40 40 0 62 11 Z" fill="#ffeca7" />
          <path d="M -10 0 H 0 C 40 0 50 -40 50 -40 C 50 -40 40 0 62 11" fill="none" stroke="#000" stroke-width="5.3" />
        </svg>
      </div>
    </div>

    <!-- 暂停界面 -->
    <div id="pause-overlay" class="pause-overlay">
      <div class="pause-menu">
        <h2 class="pause-title">游戏暂停</h2>
        <div class="pause-buttons">
          <button id="resume-btn" class="pause-btn">继续游戏</button>
          <button id="save-btn" class="pause-btn">保存存档</button>
          <button id="load-btn" class="pause-btn">读取存档</button>
          <button id="help-btn" class="pause-btn">游戏帮助</button>
          <button id="title-btn" class="pause-btn danger">保存并返回主页面</button>
        </div>
      </div>
    </div>

    <!-- 存档管理界面 -->
    <div id="save-manager-modal" class="save-manager-modal">
      <div class="save-manager-content">
        <div class="save-manager-header">
          <h2 class="save-manager-title">选择存档</h2>
          <button id="save-manager-close" class="save-manager-close">&times;</button>
        </div>
        <div class="save-list-container">
          <div id="save-list" class="save-list"></div>
        </div>
      </div>
    </div>

    <!-- 帮助界面 -->
    <div id="help-modal" class="help-modal">
      <div class="help-content">
        <div class="help-header">
          <h2 class="help-title">游戏帮助</h2>
          <button id="help-close" class="help-close">&times;</button>
        </div>
        <div class="help-text">
          <h3>基本操作</h3>
          <ul>
            <li><kbd>E</kbd> - 交互</li>
            <li><kbd>R</kbd> - 爆炸</li>
            <li><kbd>A</kbd> / <kbd>D</kbd> - 左右移动</li>
            <li><kbd>S</kbd> - 向下移动（穿越脚手架）</li>
            <li><kbd>Space</kbd> - 跳跃</li>
            <br>
            <li><kbd>Esc</kbd> - 暂停</li>
            <li><kbd>Space</kbd> / <kbd>Enter</kbd> - 对话</li>
            <li><kbd>Ctrl</kbd> - 对话快进</li>
          </ul>

          <h3>特殊技能</h3>
          <ul>
            <li><strong>土狼时间</strong>：离开平台后0.15秒内仍可跳跃</li>
            <li><strong>二段跳</strong>：在空中可以再跳跃1次</li>
            <li><strong>时间回溯</strong>：王源的秘密武器</li>
          </ul>
        </div>
      </div>
    </div>
  </main>
</body>

</html>